<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>(3) Constraints · SOCP Trajectory Optimization Documentation</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">SOCP Trajectory Optimization Documentation</span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Home</a></li><li><span class="tocitem">Using the Module</span><ul><li><a class="tocitem" href="ui.html">Overview</a></li><li><a class="tocitem" href="rocket_ui.html">(1) Rockets</a></li><li><a class="tocitem" href="objective_ui.html">(2) Objective</a></li><li class="is-active"><a class="tocitem" href="constraints_ui.html">(3) Constraints</a></li><li><a class="tocitem" href="augLag_ui.html">(4) Augmented Lagrangian</a></li><li><a class="tocitem" href="solver_ui.html">(5) Solve</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Using the Module</a></li><li class="is-active"><a href="constraints_ui.html">(3) Constraints</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="constraints_ui.html">(3) Constraints</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/danineamati/TrajOptSOCPs.jl/blob/master/docs/src/UI/constraints_ui.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="User-Interface-to-Establish-the-Constraints"><a class="docs-heading-anchor" href="#User-Interface-to-Establish-the-Constraints">User Interface to Establish the Constraints</a><a id="User-Interface-to-Establish-the-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#User-Interface-to-Establish-the-Constraints" title="Permalink"></a></h1><p>The constraints are at the heart of this project. So far, the package includes three different types of constraints:</p><ol><li>Dynamic Constraints (Affine Equality Constraints)</li><li>Ground Constraints (Affine Inequality Constraints)</li><li>Max Thrust Constraints (Second Order Cone Constraints)</li></ol><p>We will explore each of these in this order. All of the constraints are fed into a <code>constraintManager</code>.</p><h3 id="Dynamic-Constraints"><a class="docs-heading-anchor" href="#Dynamic-Constraints">Dynamic Constraints</a><a id="Dynamic-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamic-Constraints" title="Permalink"></a></h3><p>In continuous time, we have a differential equation of the form:</p><div>\[\frac{dx}{dt} = \tilde Ax + \tilde Bu + \tilde C\]</div><p>We solve this via Matrix exponentiation which yields a discretized equation of the form:</p><div>\[x_{k+1} = A x_k + B u_k + C\]</div><p>Where <span>$\tilde A \neq A$</span>, <span>$\tilde B \neq B$</span>, and <span>$\tilde C \neq C$</span>. To formulate this as an Affine Equality constraint, we want to write this in the form <span>$Ax = b$</span>. Thus we rearrange this as</p><div>\[A x_k + B u_k - I x_{k+1} = -C\]</div><p>The left hand side defines the matrix <span>$A_{DYN}$</span> and the right hand side defines <span>$b_{DYN}$</span>. Generally, we also want to include constraints on the initial and final states specifically. This is all handled together in the below call:</p><pre><code class="language-"># Create the Dynamics Constraints
const ADyn, BDyn = rocketDynamicsFull(rocket, rocketStart, rocketEnd, NSteps)</code></pre><p>Then the dynamics constraint and associated dual variable are created:</p><pre><code class="language-">dynConstraint = AL_AffineEquality(ADyn, BDyn)
lambdaInit = -1 * ones(size(BDyn))</code></pre><p>Note that the two are separated just in case the you (1) don&#39;t care about the initial or final points or (2) want the <span>$A_{DYN}$</span> matrix and <span>$b_{DYN}$</span> vector after the fact.</p><h3 id="Ground-Constraints"><a class="docs-heading-anchor" href="#Ground-Constraints">Ground Constraints</a><a id="Ground-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Ground-Constraints" title="Permalink"></a></h3><p>Currently the ground constraints only handle flat ground level with the origin. This is generally acceptable for the rocket soft landing problem since we can choose the coordinate system and rockets generally land on flat areas. However, it is totally possible to include more complicated terrain in future updates.</p><p>Since this is a simple constraint, <code>makeGroundConstraint</code> handles it in one go. We only need to provide the dimensionality and normal vector to the ground. As before, we initialize the associated dual variables.</p><pre><code class="language-"># Create the Ground Constraints
groundConstraint = makeGroundConstraint(NSteps, size(grav, 1), size(grav, 1))
groundLambda = zeros(size(groundConstraint.b, 1))</code></pre><h3 id="Max-Thrust-Constraints"><a class="docs-heading-anchor" href="#Max-Thrust-Constraints">Max Thrust Constraints</a><a id="Max-Thrust-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Max-Thrust-Constraints" title="Permalink"></a></h3><p>This is the crux of the novel addition enabled by this package. Most of the work is handled behind the scenes. The user only needs to provide the maximum thrust (as a positive <code>Float64</code>). As before, initialize the associated dual variables.</p><pre><code class="language-">thrustMax = 20.0
maxThrustConstraint = makeMaxThrustConstraint(NSteps, size(grav, 1), thrustMax)
maxThrustLambda = zeros(size(maxThrustConstraint.indicatorList))</code></pre><h3 id="Stitch-it-all-together!"><a class="docs-heading-anchor" href="#Stitch-it-all-together!">Stitch it all together!</a><a id="Stitch-it-all-together!-1"></a><a class="docs-heading-anchor-permalink" href="#Stitch-it-all-together!" title="Permalink"></a></h3><p>Now we stitch it all together. The dynamics are put as a special case, the rest of the constraints are added as an array:</p><pre><code class="language-">cMRocket = constraintManager_Dynamics([groundConstraint, maxThrustConstraint],
                                      [groundLambda, maxThrustLambda],
                                      dynConstraint, lambdaInit)</code></pre><p>For more information see:</p><article class="docstring"><header><a class="docstring-binding" id="TrajOptSOCPs.constraintManager_Dynamics" href="#TrajOptSOCPs.constraintManager_Dynamics"><code>TrajOptSOCPs.constraintManager_Dynamics</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">constraintManager_Dynamics</code></pre><p>Contains a list of constraints and the dual variables (lambda) that correspond with each constraint.</p><p>Unlike <a href="UI/@ref"><code>constraintManager_Base</code></a>, this constraint manager also has the dynamics constraints embedded such that the nearest dynamically feasible trajectory can be determined at any given time.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/danineamati/TrajOptSOCPs.jl/blob/82c6a75f0433d9fd7cb01f4a87c1289ad1e14bb7/src/constraints/constraintManagerDynamics.jl#L7-L16">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="objective_ui.html">« (2) Objective</a><a class="docs-footer-nextpage" href="augLag_ui.html">(4) Augmented Lagrangian »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 11 August 2020 17:17">Tuesday 11 August 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
